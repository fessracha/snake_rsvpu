/*
* dependences:
* - masonry (https://github.com/desandro/masonry)
* - Magnific-Popup (https://github.com/dimsemenov/Magnific-Popup)
* */
;(function ($) {

	$.fn.gallery = function (options) {

		// Создаём настройки по-умолчанию, расширяя их с помощью параметров, которые были переданы
		var settings = $.extend({}, options);

		return this.each(function () {

			//console.log(this)
			var $gallery = $(this);

			var galleryProduct = new SL($gallery);
			galleryProduct.modules(
				{
					'/vendor/Magnific-Popup-master/dist/jquery.magnific-popup': Object.getPrototypeOf($())['magnificPopup'],
					'/vendor/masonry-master/dist/masonry.pkgd': Object.getPrototypeOf($())['masonry'],
					'/vendor/imagesloaded/imagesloaded.pkgd': Object.getPrototypeOf($())['imagesLoaded'],
				},
				true
			);
			galleryProduct.run({
				callback: function () {
					$gallery.magnificPopup({
						delegate: 'a',
						type: 'image',
						gallery: {
							enabled: true,
						},
					});
					$gallery.imagesLoaded( function() {
						$gallery.masonry({
							itemSelector: '.gallery__item',
							columnWidth: '.gallery__item-sizer',
							percentPosition: true
						});
					});
				}
			});

		});

	};
})(jQuery);