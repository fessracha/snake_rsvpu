# Описание API для использования SL().

**!!!Внимание: SL() зависит от jQuery.**

В текущей реализации, заходя на сайт, мы получаем все скрипты вне зависимости от того, нужны ли они на странице. Как следствие пользователю приходиться на Главной странице загружать скрипты, которые относятся к страницам Корзина, Карточка товара, Оформление заказа, О нас и т.д. Этот загрузчик призван решить данную проблему, а то, как он будет это делать, описывается далее.

Для начала, каждый блок кода, где вы используете SL, рекомендуется оборачивать в конструкцию ниже. Это позволит вам экономить память на компьютере клиента. После обработки интерпретатором данной конструкции все переменные и экземпляры SL будут автоматически удалены из памяти.
```js
(function() {
  // Ваш код...
})()
```

В следующем блоке кода показано как создавать экземпляр SL. При создании объекта в конструктор передается непустой jQuery object, или элемент DOM, или false.

При передаче jQuery object или элемента DOM, SL будет загружать и выполнять переданные ему модули только в том случае, если jQuery object или элемент DOM существуют на данной странице.

При передаче false, вы сообщаете SL, что модуль не зависит от элементов на странице и его нужно загрузить и исполнить в любом случаи. 
```js
var $div = $('div');
var example = new SL($div);
// или
var example = new SL(getItemElement('div'));
// или
var example = new SL(false);
```

Далее мы используем метод SL.modules(). В него мы передаем объект `{}` с модулями. Объект содержащий путь до модуля и способ определения загружен ли модуль в данный момент или нет.

**!!!ВНИМАНИЕ, путь до модуля указывается без расширения и без суффикса ".min".**

По умолчанию к пути до модуля будет подставляться ".min.js". Данное поведение можно изменить используя режим отладки, который будет описан выше.
```js
var min_js = true;
example.modules(
  {
    '/dist/js/modules/example': Object.getPrototypeOf($())['example'],
    '/dist/js/modules/example2': Object.getPrototypeOf($())['example2'], // пример для jQuery
  }
);
```

И наконец, завершающий метод SL.run(). Метод загружает переданные модули и исполняет функций, переданные в объекте, которые сработают в жизненном цикле SL(). В частности:

callback - Функция которая сработает при удачной загрузки всех переданных модулей.

callbackError - Функция которая сработает при неудачной загрузки какого-либо модуля.
```js
example.run({
  callback:function () {
    $('div').example();
    $('div').example2();
  }
});
```
---
Итоговый код:
```js
(function() {
  var $div = $('div');
  var example = new SL($div);
  example.modules(
    {
      '/dist/js/modules/example': Object.getPrototypeOf($())  ['example'],
      '/dist/js/modules/example2': Object.getPrototypeOf($())  ['example2'], // пример для jQuery
    }
  );
  example.run({
    callback:function () {
      $('div').example();
      $('div').example2();
    }
  });
})()
```
---

У SL() присутствует режим дебага. В нем к пути до модуля подставляется не ".min.js", а ".js", а также в консоль выводится информация о загрузке модулей.
Для включения этого режима нужно перед созданием экземпляра конструктора SL() в глобальный объект window внести свойство _isDev со значением true
```js
window._isDev = true;
(function () {
  let example = new SL();
  // ...
})()
```